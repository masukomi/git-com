#+title: README

* git-com
A tool that makes it easy to produce structured commit messages, that are easily customizable to your project's need.

** Example
#+begin_src text
[documentation] enhancement: adding to the spec

Documenting some more of the edge cases we'll have to handle
so that we make sure to get everything right.

Ticket: 12345

Tags: hotfix, refactoring
#+end_src

That commit message is made up of many interactive component parts. Some are optional. Some are required. The commit message above is a complex example made up of the following elements.

#+begin_src
<code-section> <change-type> <commit-title>

<commit-description>

<ticket-number>

<tags>
#+end_src

- =<code-section>= is a modifiable select list
- =<change-type>= is a modifiable select list
- =<commit-title>= is a simple text input
- =<commit-description>= is a multi-line text input
- =<ticket-number>= is an /optional/ input that (in this configuration) will validate that the user has entered an integer.
- =<tags>= is an /optional/ multi-select list
* How it Works
Once you've added the =git-com= executable to your path, typing =git com= instead of the usual =git commit= will invoke a series of prompts based on what you configure in your =.git-com.yaml= file at the root of your git repository. The resulting text is combined to make a structured commit message.

There can be as many, or as few elements in your configuration as you want. The /only/ requirement is that you have at least one element in your YAML whose input will end up in the commit title.

You can also add text around the user submitted input. In the example above the =<code-section>= is configured with ~"["~ as its ~before-string~ and ~"]"~ as its ~after-string~. I just chose =documentation= from the select list it showed me.

* Installation

** Prerequisites
- Go 1.21 or later
- Git

** Building from Source
Clone the repository and build:

#+begin_src bash
git clone https://github.com/yourusername/git-com.git
cd git-com
go build -o git-com .
#+end_src

** Installing
Move the binary to a directory in your PATH:

#+begin_src bash
# Linux/macOS
sudo mv git-com /usr/local/bin/

# Or add to your personal bin directory
mv git-com ~/bin/
#+end_src

** Git Integration
Because the executable is named =git-com=, Git will automatically recognize it as a subcommand. Once installed, you can run:

#+begin_src bash
git com
#+end_src

This works because Git looks for executables named =git-<command>= when you type =git <command>=.

* Usage

1. Create a =.git-com.yaml= (or =.git-com.yml=) file in the root of your Git repository
2. Stage your changes with =git add=
3. Run =git com= instead of =git commit=
4. Answer the interactive prompts
5. Your commit is created with a structured message

** Aborting
Press =Ctrl+C= or =Esc= at any prompt to abort without creating a commit.

* The configuration file
When =git-com= runs it will look for a =.git-com.yaml= or =.git-com.yml= file at the root of your repository. It's a good idea to commit this file, especially if you work on a team that wants to use =git-com= so that they can always have consistently structured commit messages with all the important info.

** Overall structure
The configuration file is a YAML document where each top-level key defines an element. Elements are processed in the order they appear in the file, and each element prompts the user for input.

#+begin_src yaml
element-name:
  destination: title  # or body
  type: text          # element type
  # ... additional attributes
#+end_src

The key (=element-name=) is used internally to identify the element. It doesn't appear in the commit message unless you want it to (via =before-string= or =after-string=).

*** Required Attributes (All Elements)
- =destination= - Where the input goes: =title= or =body=
- =type= - The element type (see below). Can be omitted if =data-type= is specified, in which case =text= is assumed.

*** Optional Attributes (All Elements)
| Attribute       | Description                                        | Default |
|-----------------+----------------------------------------------------+---------|
| =instructions=  | Text displayed above the input prompt              | /none/  |
| =before-string= | Text prepended to the user's input                 | /none/  |
| =after-string=  | Text appended to the user's input                  | /none/  |
| =allow-empty=   | Whether empty input is accepted                    | =false= |

*Note:* Elements with =destination: title= cannot have newlines in =before-string= or =after-string=.

** Elements

*** text
A single-line text input field.

**** Required Attributes
- =destination=
- =type: text= (can be omitted if =data-type= is specified)

**** Optional Attributes
| Attribute     | Description                                            | Default  |
|---------------+--------------------------------------------------------+----------|
| =placeholder= | Grayed-out hint text shown in empty input              | /none/   |
| =data-type=   | Validation type: =string=, =integer=, or =float=       | =string= |

Note: You generally don't want to have instructions /and/ a placeholder.
**** Example
#+begin_src yaml
commit-title:
  destination: title
  type: text
  instructions: "Enter a brief description of your changes"
  placeholder: "What did you change?"

ticket-number:
  destination: body
  data-type: integer
  before-string: "Ticket: "
  allow-empty: true
  instructions: "Enter the ticket number (optional)"
#+end_src

*** multiline-text
A multi-line text editor for longer input. Press =Enter= for new lines and =Ctrl+D= to submit.

**** Required Attributes
- =destination=
- =type: multiline-text=

**** Optional Attributes
| Attribute     | Description                               | Default |
|---------------+-------------------------------------------+---------|
| =placeholder= | Hint text shown in empty editor           | /none/  |

Note: You generally don't want to have instructions /and/ a placeholder.
**** Example
#+begin_src yaml
commit-description:
  destination: body
  type: multiline-text
  instructions: "Describe your changes in detail"
  placeholder: "Why did you make these changes?"
  allow-empty: true
#+end_src

*** select
A single-choice selection from a list of options.

**** Required Attributes
- =destination=
- =type: select=
- =options= - List of choices

**** Optional Attributes
| Attribute    | Description                                           | Default |
|--------------+-------------------------------------------------------+---------|
| =modifiable= | Allow users to add new options (saved to config file) | =false= |

If modifiable is set to =true=, an "Other…" element will be added to the list and - if chosen - will allow the user to add a new element which will then be saved into their =.git-com.y[a]ml= file for future use.

**** Example
#+begin_src yaml
change-type:
  destination: title
  type: select
  instructions: "What type of change is this?"
  options:
    - feat
    - fix
    - docs
    - refactor
    - test
  modifiable: true
  after-string: ": "
#+end_src

*** multi-select
A multiple-choice selection from a list of options. Use =Space= to select items and =Enter= to submit.

**** Required Attributes
- =destination=
- =type: multi-select=
- =options= - List of choices
- =record-as= - Output format: =list= or =joined-string=

*Note:* It is generally /not/ a good idea to use a =multi-select= if you're adding its output to the title of your git commit.

When =destination= is =title=, =record-as= must be =joined-string=. The =list= format contains newlines which are not allowed in commit titles.

**** Optional Attributes
| Attribute              | Description                                                | Default          |
|------------------------+------------------------------------------------------------+------------------|
| =modifiable=           | Allow users to add new options (saved to config file)      | =false=          |
| =limit=                | Maximum number of selections (0 = unlimited)               | =0=              |
| =bullet-string=        | Prefix for each item when =record-as: list=                | ="- "=           |
| =join-string=          | Separator when =record-as: joined-string=                  | =", "=           |
| =empty-selection-text= | Label for the "skip" option (requires =allow-empty: true=) | ="No Selection"= |

If modifiable is set to =true=, an "Other…" element will be added to the list and - if chosen - will allow the user to add a new element which will then be saved into their =.git-com.y[a]ml= file for future use.

***** empty-selection-text
It's not currently possible to /not/ select something in a =multi-select=, but sometimes you want the =multi-select= to be optional (=allow-empty: true=). We work around that limitation by adding a meta-element that - when chosen - tells the system that the user is choosing to /not/ choose.

By default, an optional =multi-select= will have a /No Selection/ option added to the top of the list. Setting =empty-selection-text= will override that default text with whatever string you provide.
***** bullet-string
Setting =bullet-string= changes what's displayed before each line of a list of items chosen in a =multi-select=

This is (optionally) used when =record-as= is set to =list=

Default example:

#+begin_src text
- foo
- bar
#+end_src

Setting =bullet-string= to ="• "= would give you this in your commit message

#+begin_src text
• foo
• bar
#+end_src
***** join-string
⚠️ note this is =join-string= not =joined-string=

Same idea as =bullet-string= but used when =record-as= is (optionally) set to =joined-string=

#+begin_src text
foo, bar, baz
#+end_src

Setting =join-string= to =" / "= would give you this in your commit message

#+begin_src text
foo / bar / baz
#+end_src

**** Example
#+begin_src yaml
tags:
  destination: body
  type: multi-select
  instructions: "Select applicable tags"
  options:
    - breaking-change
    - hotfix
    - refactoring
    - performance
    - security
  record-as: joined-string
  join-string: ", "
  before-string: "Tags: "
  allow-empty: true
  empty-selection-text: "Skip tags"
  modifiable: true

affected-areas:
  destination: body
  type: multi-select
  instructions: "What areas of the codebase are affected?"
  options:
    - frontend
    - backend
    - database
    - api
    - tests
  record-as: list
  bullet-string: "- "
  before-string: "\nAffected Areas:\n"
  limit: 3
#+end_src

*** confirmation
A yes/no confirmation prompt. Selecting "No" aborts the commit.

**** Required Attributes
- =destination=
- =type: confirmation=

**** Example
#+begin_src yaml
confirm-commit:
  destination: body
  type: confirmation
  instructions: "Are you sure you want to create this commit?"
#+end_src

*Note:* The confirmation element doesn't add any text to the commit message. It's purely for workflow control.

** Complete Example
Here's the configuration that would produce the example commit message shown at the top of this document:

#+begin_src yaml
code-section:
  destination: title
  type: select
  instructions: "Which part of the codebase does this affect?"
  options:
    - input
    - git
    - output
    - documentation
    - testing
  modifiable: true
  before-string: "["
  after-string: "] "

change-type:
  destination: title
  type: select
  instructions: "What type of change is this?"
  options:
    - feat
    - fix
    - enhancement
    - refactor
    - docs
  modifiable: true
  after-string: ": "

commit-title:
  destination: title
  type: text
  instructions: "Enter a brief commit title"
  placeholder: "Summarize your changes"

commit-description:
  destination: body
  type: multiline-text
  instructions: "Describe your changes (optional)"
  allow-empty: true

ticket-number:
  destination: body
  type: text
  data-type: integer
  instructions: "Enter the ticket number (optional)"
  before-string: "\nTicket: "
  allow-empty: true

tags:
  destination: body
  type: multi-select
  instructions: "Select any applicable tags (optional)"
  options:
    - hotfix
    - refactoring
    - breaking-change
    - performance
  record-as: joined-string
  join-string: ", "
  before-string: "\nTags: "
  allow-empty: true
  empty-selection-text: "No tags"
  modifiable: true
#+end_src

* Tips

** Modifiable Lists
When =modifiable: true= is set on a select or multi-select element, an "Other…" option appears at the bottom of the list. Selecting it prompts for a new value, which is:
1. Used in the current commit
2. Automatically saved to your =.git-com.yaml= file for future use

This is useful for growing your options organically as your project evolves.

** Element Order Matters
Elements are processed in the order they appear in the YAML file. Plan your configuration so that related items flow naturally. Title elements typically come first, followed by body elements.

** Before and After Strings
Use =before-string= and =after-string= to add formatting without requiring user input:
- Add prefixes like ="["= or ="Ticket: "=
- Add suffixes like ="]"= or =": "=
- Add newlines in body elements with ="\n"= for spacing

** Optional vs Required
By default, all elements require input. Set =allow-empty: true= to make an element optional. For multi-select, you can customize the skip option text with =empty-selection-text=.
