#+title: Config File Details

* The configuration file
When =git-com= runs it will look for a =.git-com.yaml= or =.git-com.yml= file at the root of your repository. It's a good idea to commit this file, especially if you work on a team that wants to use =git-com= so that they can always have consistently structured commit messages with all the important info.

** Overall structure
The configuration file is a YAML document where each top-level key defines an element. Elements are processed in the order they appear in the file, and each element prompts the user for input.

#+begin_src yaml
element-name:
  destination: title  # or body
  type: text          # element type
  # ... additional attributes
#+end_src

The key (=element-name=) is used internally to identify the element. It doesn't appear in the commit message unless you want it to (via =before-string= or =after-string=).

*** Required Attributes (All Elements)
- =destination= - Where the input goes: =title= or =body=
- =type= - The element type (see below). Can be omitted if =data-type= is specified, in which case =text= is assumed.

*** Optional Attributes (All Elements)
| Attribute       | Description                                        | Default |
|-----------------+----------------------------------------------------+---------|
| =instructions=  | Text displayed above the input prompt              | /none/  |
| =before-string= | Text prepended to the user's input                 | /none/  |
| =after-string=  | Text appended to the user's input                  | /none/  |
| =allow-empty=   | Whether empty input is accepted                    | =false= |

*Note:* Elements with =destination: title= cannot have newlines in =before-string= or =after-string=.

** Elements

*** text
A single-line text input field.

#+ATTR_HTML: :alt screenshot of text input with instructions provided
#+ATTR_HTML: :title text input with instructions
[[image-url:https://git-com.masukomi.org/images/screenshots/text_with_instructions@2x.png]]


#+ATTR_HTML: :alt screenshot of text input with placeholder provided
#+ATTR_HTML: :title text input with placeholder
[[image-url:https://git-com.masukomi.org/images/screenshots/text_with_placeholder@2x.png]]

**** Required Attributes
- =destination=
- =type: text= (can be omitted if =data-type= is specified)

**** Optional Attributes
| Attribute     | Description                                            | Default  |
|---------------+--------------------------------------------------------+----------|
| =placeholder= | Grayed-out hint text shown in empty input              | /none/   |
| =data-type=   | Validation type: =string=, =integer=, or =float=       | =string= |

Note: You generally don't want to have instructions /and/ a placeholder.
**** Example
#+begin_src yaml
commit-title:
  destination: title
  type: text
  instructions: "Enter a brief description of your changes"
  placeholder: "What did you change?"

ticket-number:
  destination: body
  data-type: integer
  before-string: "Ticket: "
  allow-empty: true
  instructions: "Enter the ticket number (optional)"
#+end_src

*** multiline-text
A multi-line text editor for longer input. Press =Enter= for new lines and =Ctrl+D= to submit.

#+ATTR_HTML: :alt screenshot of multiline-text input with placeholder
#+ATTR_HTML: :title multiline-text with placeholder
[[image-url:https://git-com.masukomi.org/images/screenshots/multiline-text@2x.png]]

**** Required Attributes
- =destination=
- =type: multiline-text=

**** Optional Attributes
| Attribute     | Description                     | Default            |
|---------------+---------------------------------+--------------------|
| =placeholder= | Hint text shown in empty editor | "Write something‚Ä¶" |

Note: You generally don't want to have instructions /and/ a placeholder.
**** Example
#+begin_src yaml
commit-description:
  destination: body
  type: multiline-text
  instructions: "Describe your changes in detail"
  placeholder: "Why did you make these changes?"
  allow-empty: true
#+end_src

*** select
A single-choice selection from a list of options.

#+ATTR_HTML: :alt screenshot of select input with instructions
#+ATTR_HTML: :title select input with instructions
[[image-url:https://git-com.masukomi.org/images/screenshots/select@2x.png]]

**** Required Attributes
- =destination=
- =type: select=
- =options= - List of choices

**** Optional Attributes
| Attribute    | Description                                           | Default |
|--------------+-------------------------------------------------------+---------|
| =modifiable= | Allow users to add new options (saved to config file) | =false= |

If modifiable is set to =true=, an "Other‚Ä¶" element will be added to the list and - if chosen - will allow the user to add a new element which will then be saved into their =.git-com.y[a]ml= file for future use.

**** Example
#+begin_src yaml
change-type:
  destination: title
  type: select
  instructions: "What type of change is this?"
  options:
    - feat
    - fix
    - docs
    - refactor
    - test
  modifiable: true
  after-string: ": "
#+end_src

*** multi-select
A multiple-choice selection from a list of options. Use =Space= to select items and =Enter= to submit.

#+ATTR_HTML: :alt screenshot of multi-select input with instructions multiple items have been selected.
#+ATTR_HTML: :title multi-select input with 2 options selected.
[[image-url:https://git-com.masukomi.org/images/screenshots/multi-select@2x.png]]

**** Required Attributes
- =destination=
- =type: multi-select=
- =options= - List of choices
- =record-as= - Output format: =list= or =joined-string=

*Note:* It is generally /not/ a good idea to use a =multi-select= if you're adding its output to the title of your git commit.

When =destination= is =title=, =record-as= must be =joined-string=. The =list= format contains newlines which are not allowed in commit titles.

**** Optional Attributes
| Attribute              | Description                                                | Default          |
|------------------------+------------------------------------------------------------+------------------|
| =modifiable=           | Allow users to add new options (saved to config file)      | =false=          |
| =limit=                | Maximum number of selections (0 = unlimited)               | =0=              |
| =bullet-string=        | Prefix for each item when =record-as: list=                | ="- "=           |
| =join-string=          | Separator when =record-as: joined-string=                  | =", "=           |
| =empty-selection-text= | Label for the "skip" option (requires =allow-empty: true=) | ="No Selection"= |

If modifiable is set to =true=, an "Other‚Ä¶" element will be added to the list and - if chosen - will allow the user to add a new element which will then be saved into their =.git-com.y[a]ml= file for future use.

***** empty-selection-text
It's not currently possible to /not/ select something in a =multi-select=, but sometimes you want the =multi-select= to be optional (=allow-empty: true=). We work around that limitation by adding a meta-element that - when chosen - tells the system that the user is choosing to /not/ choose.

By default, an optional =multi-select= will have a /No Selection/ option added to the top of the list. Setting =empty-selection-text= will override that default text with whatever string you provide.
***** bullet-string
Setting =bullet-string= changes what's displayed before each line of a list of items chosen in a =multi-select=

This is (optionally) used when =record-as= is set to =list=

Default example:

#+begin_src text
- foo
- bar
#+end_src

Setting =bullet-string= to ="‚Ä¢ "= would give you this in your commit message

#+begin_src text
‚Ä¢ foo
‚Ä¢ bar
#+end_src
***** join-string
‚ö†Ô∏è note this is =join-string= not =joined-string=

Same idea as =bullet-string= but used when =record-as= is (optionally) set to =joined-string=

#+begin_src text
foo, bar, baz
#+end_src

Setting =join-string= to =" / "= would give you this in your commit message

#+begin_src text
foo / bar / baz
#+end_src

**** Example
#+begin_src yaml
tags:
  destination: body
  type: multi-select
  instructions: "Select applicable tags"
  options:
    - breaking-change
    - hotfix
    - refactoring
    - performance
    - security
  record-as: joined-string
  join-string: ", "
  before-string: "Tags: "
  allow-empty: true
  empty-selection-text: "Skip tags"
  modifiable: true

affected-areas:
  destination: body
  type: multi-select
  instructions: "What areas of the codebase are affected?"
  options:
    - frontend
    - backend
    - database
    - api
    - tests
  record-as: list
  bullet-string: "- "
  before-string: "\nAffected Areas:\n"
  limit: 3
#+end_src

*** confirmation
A yes/no confirmation prompt. Selecting "No" /always aborts/ the commit regardless of where it is in your flow. Use this to sanity check that contributors have done some required task before proceeding.

You'll see an example of this at the end of every git-com run.

#+ATTR_HTML: :alt screenshot of  instructions
#+ATTR_HTML: :title select input with instructions
[[image-url:https://git-com.masukomi.org/images/screenshots/confirmation@2x.png]]


**** Required Attributes
- =type: confirmation=

**** Example
#+begin_src yaml
confirm-commit:
  type: confirmation
  instructions: "Are you sure you want to create this commit?"
#+end_src

*Note:* The confirmation element doesn't add any text to the commit message. It's purely for workflow control.

** Complete Example

#+begin_src text
[docs] enhancement: adding to the spec

Documenting some more of the edge cases we'll have to handle
so that we make sure to get everything right.

Ticket: 12345

Tags: hotfix, refactoring
#+end_src

Here's a configuration that could produce that commit message.

#+begin_src yaml
code-section:
  destination: title
  type: select
  instructions: "Which part of the codebase does this affect?"
  options:
    - input
    - git
    - output
    - documentation
    - testing
  modifiable: true
  before-string: "["
  after-string: "] "

change-type:
  destination: title
  type: select
  instructions: "What type of change is this?"
  options:
    - feat
    - fix
    - enhancement
    - refactor
    - docs
  modifiable: true
  after-string: ": "

commit-title:
  destination: title
  type: text
  instructions: "Enter a brief commit title"
  placeholder: "Summarize your changes"

commit-description:
  destination: body
  type: multiline-text
  instructions: "Describe your changes (optional)"
  allow-empty: true

ticket-number:
  destination: body
  type: text
  data-type: integer
  instructions: "Enter the ticket number (optional)"
  before-string: "\nTicket: "
  allow-empty: true

tags:
  destination: body
  type: multi-select
  instructions: "Select any applicable tags (optional)"
  options:
    - hotfix
    - refactoring
    - breaking-change
    - performance
  record-as: joined-string
  join-string: ", "
  before-string: "\nTags: "
  allow-empty: true
  empty-selection-text: "No tags"
  modifiable: true
#+end_src

* Tips
** Element Order Matters
Elements are processed in the order they appear in the YAML file. Plan your configuration so that related items flow naturally. Title elements typically come first, followed by body elements.
** Keep Title Options Short
Having a pulldown for what part of a project the commit pertains to is one of the most useful things I do with =git-com=, however I recommend:
- limit it to one =select= option in the title
- don't use =multi-select= options in the title.
  You can, but you shouldn't.
- keep the options short. E.g. use "docs" instead of "documentation"

[[https://martijnhols.nl/blog/how-to-write-a-good-git-commit-message][An ideal commit message]] has a title of 50 characters or less, after 72 characters many tools (including GitHub) start cutting things off. That's not a lot to work with. Specifying the part of the project helps save some descriptive words, but can also hurt if the option is too long.
** Modifiable Lists
When =modifiable: true= is set on a select or multi-select element, an "Other‚Ä¶" option appears at the bottom of the list. Selecting it prompts for a new value, which is:
1. Used in the current commit
2. Automatically saved to your =.git-com.yaml= file for future use

This is useful for growing your options organically as your project evolves.

** Before and After Strings
Use =before-string= and =after-string= to add formatting without requiring user input:
- Add prefixes like ="["= or ="Ticket: "=
- Add suffixes like ="] "= or =": "=
- Add newlines in body elements with ="\n"= for spacing

üí° Tip: If text will follow on the same line, be sure to include a trailing space in your =after-string=. Ex. use =": "= not =":"=
** Optional vs Required
By default, all elements require input. Set =allow-empty: true= to make an element optional. For multi-select, you can customize the skip option text with =empty-selection-text=.

** Emoji üòÄ
Emoji are fine within the body of a commit, but don't use them in more structured elements like select options. A single emoji can be comprised of multiple code-points which are invisibly combined, and can cause headaches when trying to find matching commits.

If it's something you're going to be searching for, or using to generate reports, don't include emoji in it.
